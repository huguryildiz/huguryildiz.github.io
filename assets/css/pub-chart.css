/* =========================================================
   pub-chart.css (FULL)
   - Donut cards + theme tokens
   - Legend below donut
   - Sticky Filter panel (no overlap)
   - Light/Dark compatible inputs and text
   ========================================================= */

/* -------------------------
   Theme tokens
------------------------- */
:root{
  --pub-text: #222;
  --pub-muted: rgba(0,0,0,.60);
  --pub-border: rgba(0,0,0,.14);
  --pub-card-bg: #fff;
  --pub-shadow: 0 10px 26px rgba(0,0,0,.10);

  /* Donut segment label */
  --pub-seg-fill: #fff;
  --pub-seg-stroke: rgba(0,0,0,.45);

  /* Accent: DOI Available blue-ish */
  --pub-accent: #2f6fbd;
  --pub-accent-hover: #2a62a8;
  --pub-accent-soft: rgba(47,111,189,.12);

  /* Sticky offset (MM theme header varsa rahatlatÄ±r) */
  --pub-sticky-top: 14px;
}

/* Dark theme switches */
[data-theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
html.dark, body.dark,
html.dark-mode, body.dark-mode,
html.theme-dark, body.theme-dark{
  --pub-text: rgba(255,255,255,.95);
  --pub-muted: rgba(255,255,255,.70);
  --pub-card-bg: rgba(255,255,255,.08);
  --pub-shadow: 0 14px 34px rgba(0,0,0,.55);
  --pub-border: rgba(255,255,255,.14);

  /* select background in dark */
  --pub-select-bg: rgba(255,255,255,.10);
  --pub-select-border: rgba(255,255,255,.18);
}

/* OS fallback */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]){
    --pub-text: rgba(255,255,255,.95);
    --pub-muted: rgba(255,255,255,.70);
    --pub-card-bg: rgba(255,255,255,.08);
    --pub-shadow: 0 14px 34px rgba(0,0,0,.55);
    --pub-border: rgba(255,255,255,.14);
  }
}

/* -------------------------
   Donut grid wrapper
------------------------- */
.pub-donuts-2col{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 18px;
  align-items: start;
  margin: 10px 0 18px 0;
}
@media (max-width: 900px){
  .pub-donuts-2col{ grid-template-columns: 1fr; }
}

/* -------------------------
   Card (donut container)
------------------------- */
.pub-chart{
  padding: 14px;
  border: 1px solid var(--pub-border);
  border-radius: 14px;
  background: var(--pub-card-bg);
  box-shadow: var(--pub-shadow);
  color: var(--pub-text);
}

.pub-chart__title{
  font-size: 1.05rem;
  font-weight: 800;
  margin: 0 0 10px 0;
  color: var(--pub-text);
}

/* -------------------------
   Donut layout: legend below
------------------------- */
.qdonut-wrap{
  display: grid;
  grid-template-columns: 1fr;
  gap: 14px;
  align-items: center;
}

.qdonut-svg{
  max-width: 260px;
  margin: 0 auto;
  shape-rendering: geometricPrecision;
  text-rendering: geometricPrecision;
  color: var(--pub-text);
}

.qdonut-hole{ fill: var(--pub-card-bg); }

.qdonut-total{
  font-size: 34px;
  font-weight: 900;
  fill: currentColor;
}
.qdonut-sub{
  font-size: 15px;
  font-weight: 700;
  fill: currentColor;
  opacity: .72;
}

.qdonut-count{
  font-size: 18px;
  font-weight: 800;
  fill: var(--pub-seg-fill);
  paint-order: stroke fill;
  stroke: var(--pub-seg-stroke);
  stroke-width: 3px;
  stroke-linejoin: round;
}

/* Legend below donut */
.qdonut-legend{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 12px 18px;
  align-content: start;
  color: var(--pub-text);
}

.qdonut-legend__row{
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 18px;
  font-weight: 650;
  color: inherit;
  line-height: 1.2;
}

.qdonut-legend__swatch{
  width: 14px;
  height: 14px;
  border-radius: 4px;
  flex: 0 0 auto;
  border: 1px solid var(--pub-border);
}

/* Force text colors (SVG + legend) */
.pub-chart svg{ color: var(--pub-text) !important; }
.pub-chart .qdonut-total,
.pub-chart .qdonut-sub{ fill: var(--pub-text) !important; }
.pub-chart .qdonut-legend,
.pub-chart .qdonut-legend__row{ color: var(--pub-text) !important; }
.pub-chart .qdonut-count{
  fill: var(--pub-seg-fill) !important;
  stroke: var(--pub-seg-stroke) !important;
}

/* =========================================================
   Sticky Filter Panel (NO OVERLAP in dark mode)
   ========================================================= */

.pub-filter-sticky{
  position: sticky;
  top: var(--pub-sticky-top);
  z-index: 20;                    /* stays above list */
  margin: 18px 0 26px 0;
  padding: 16px 18px;
  border: 1px solid var(--pub-border);
  border-radius: 18px;
  background: var(--pub-card-bg);
  box-shadow: var(--pub-shadow);
  color: var(--pub-text);

  /* prevents the section title from sliding under it visually */
  backdrop-filter: saturate(120%) blur(6px);
}

/* sticky header */
.pub-filter-header{
  margin: 0 0 12px 0;
}
.pub-filter-title{
  margin: 0;
  font-weight: 900;
  font-size: 1.65rem;
  color: var(--pub-text);
}

/* filter row */
.pub-filter{
  display: flex;
  gap: 14px;
  flex-wrap: wrap;
  align-items: flex-end;
}

/* label blocks */
.pub-filter-label{
  display: grid;
  gap: 8px;
  min-width: 260px;
}

.pub-filter-label-text{
  font-weight: 800;
  font-size: 1.25rem;
  color: var(--pub-text);
}

/* selects: IMPORTANT (light mode text disappearing fix) */
.pub-filter-select{
  height: 54px;
  padding: 10px 14px;
  border-radius: 14px;

  background: var(--pub-card-bg);
  color: var(--pub-text);
  border: 1px solid var(--pub-border);

  font-size: 24px;
  font-weight: 650;

  outline: none;
  box-shadow: 0 4px 12px rgba(0,0,0,.06);
  -webkit-appearance: none;
  appearance: none;
}

/* options (some browsers need explicit) */
.pub-filter-select option{
  color: #111;
}
[data-theme="dark"] .pub-filter-select option,
html.dark .pub-filter-select option,
body.dark .pub-filter-select option{
  color: #111; /* dropdown list usually white anyway */
}

/* dark select surfaces */
[data-theme="dark"] .pub-filter-select,
html.dark .pub-filter-select,
body.dark .pub-filter-select{
  background: rgba(255,255,255,.10);
  border-color: rgba(255,255,255,.18);
  color: rgba(255,255,255,.95);
}

/* count text */
.pub-count-text{
  margin-top: 14px;
  font-style: italic;
  font-size: 1.65rem;
  color: var(--pub-muted);
}

/* Prevent headings getting hidden under sticky when using anchors */
h2, h3, h4{
  scroll-margin-top: calc(var(--pub-sticky-top) + 140px);
}

/* Add spacing between sticky panel and first heading in list */
.pub-filter-sticky + h2,
.pub-filter-sticky + h3,
.pub-filter-sticky + h4{
  margin-top: 26px !important;
}

/* =========================================================
   Buttons: DOI Blue theme + Apply active/passive
   ========================================================= */

.pub-filter-sticky .btn{
  border-radius: 10px;
  line-height: 1;
  padding: 14px 18px;
}

/* Apply */
.pub-filter-sticky #pubApply{
  background: var(--pub-accent) !important;
  border-color: var(--pub-accent) !important;
  color: #fff !important;
}
.pub-filter-sticky #pubApply:hover{
  background: var(--pub-accent-hover) !important;
  border-color: var(--pub-accent-hover) !important;
}

/* Apply disabled */
.pub-filter-sticky #pubApply.is-disabled,
.pub-filter-sticky #pubApply:disabled{
  opacity: .45 !important;
  cursor: not-allowed !important;
}

/* Reset */
.pub-filter-sticky #pubReset{
  background: transparent !important;
  border: 1px solid var(--pub-accent) !important;
  color: var(--pub-accent) !important;
}
.pub-filter-sticky #pubReset:hover{
  background: var(--pub-accent-soft) !important;
}

/* Mobile: nicer stacking */
@media (max-width: 780px){
  .pub-filter-label{ min-width: 100%; }
  .pub-filter-sticky .btn{ width: auto; }
}